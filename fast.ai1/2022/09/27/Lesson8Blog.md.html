<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Fast.ai Lessons 8 Roundup | RvCode</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Fast.ai Lessons 8 Roundup" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="My personal website." />
<meta property="og:description" content="My personal website." />
<link rel="canonical" href="https://exiomius.github.io/Blogs/fast.ai1/2022/09/27/Lesson8Blog.md.html" />
<meta property="og:url" content="https://exiomius.github.io/Blogs/fast.ai1/2022/09/27/Lesson8Blog.md.html" />
<meta property="og:site_name" content="RvCode" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-09-27T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Fast.ai Lessons 8 Roundup" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-09-27T00:00:00-05:00","datePublished":"2022-09-27T00:00:00-05:00","description":"My personal website.","headline":"Fast.ai Lessons 8 Roundup","mainEntityOfPage":{"@type":"WebPage","@id":"https://exiomius.github.io/Blogs/fast.ai1/2022/09/27/Lesson8Blog.md.html"},"url":"https://exiomius.github.io/Blogs/fast.ai1/2022/09/27/Lesson8Blog.md.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/Blogs/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://exiomius.github.io/Blogs/feed.xml" title="RvCode" /><link rel="shortcut icon" type="image/x-icon" href="/Blogs/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/Blogs/">RvCode</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/Blogs/about/">About Me</a><a class="page-link" href="/Blogs/search/">Search</a><a class="page-link" href="/Blogs/categories/">Projects</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Fast.ai Lessons 8 Roundup</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-09-27T00:00:00-05:00" itemprop="datePublished">
        Sep 27, 2022
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      5 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/Blogs/categories/#Fast.ai1">Fast.ai1</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/exiomius/Blogs/tree/master/_notebooks/2022-09-27-Lesson8Blog.md.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/Blogs/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/exiomius/Blogs/master?filepath=_notebooks%2F2022-09-27-Lesson8Blog.md.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/Blogs/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/exiomius/Blogs/blob/master/_notebooks/2022-09-27-Lesson8Blog.md.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/Blogs/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Fexiomius%2FBlogs%2Fblob%2Fmaster%2F_notebooks%2F2022-09-27-Lesson8Blog.md.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/Blogs/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-09-27-Lesson8Blog.md.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Lesson-Overview">Lesson Overview<a class="anchor-link" href="#Lesson-Overview"> </a></h1><p>(This post is in progress.)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="The-topics-covered,-briefly">The topics covered, briefly<a class="anchor-link" href="#The-topics-covered,-briefly"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Lecture-Notes">Lecture Notes<a class="anchor-link" href="#Lecture-Notes"> </a></h1><ul>
<li>Back to collaborative filtering notebook, about embedding matrix. </li>
<li>PyTorch keeps track of neural network parameters/weights for you.</li>
<li>movie_bias is the interference parameter we created in order to add bias for movies, user_bias is the one we created in order to add bias for users.</li>
<li>How does our model work? To predict, it trains as normal on the input ratings and output movie ratings, but then we add meaningful interference parameters, movie_bias and user_bias for each movie and user respectively, to adjust with domain specific knowledge. Some movies just everyone likes, so are biased, some users just like every movie, so are biased.</li>
<li>Visualsing embeddings: Plotting a principle component analysis of PCA component 1 and 2, gives a compressed view of how our latent factors effect eachother. It gives us a graph to interpret how the top latent factors are related to eachother. Domain specific knowledge would tell us what there PCA components/inference factors are, and we can try and understand why they relate the way they do.</li>
<li>Embedding distance: calculate how far apart each embedding vector is from a specific movie, aka how similar each movie is compared to that movie based on the latent factors.</li>
<li>Using deep learning for collaborative filtering instead: We use a neural net to try and enter the missing values in the matrix.</li>
<li>we use fast.ai to try and find the embedding matrix side/number of latent variables. </li>
<li>In practice, a combined approach of a neural net and dot product approach is best for collaborative filtering. </li>
<li>In collab filtering, often a small number of users and movies overwealm the rest. In anime for example, some users watch so much anime compared to the rest and this screws up predictions for normal users. It's a higher level task to try and resolve this.</li>
<li>Embedding in NLP: an embedding matrix is just a matrix of latent variables for every word. And as before, the embedding distance calculates the embedding distance between a word and other words, telling us how similar they are based on latent variables.</li>
<li>For tabular data, using a tabular model/learner for it, creates an embedding matrix, and uses it.</li>
<li>Collab filtering, NLP, tabular data neural nets, all use embedding matrices. </li>
<li>Using embedding, latent variables, may be a substitute to doing a lot of feature engineering. </li>
<li>Create and train a neural net, take its embeddings and use it with other models like random forests, it can give a nice performance boost.</li>
<li>One latent variable found to help predict retail store sales, was distance in real life. Actually the embedding matrix's distances for that latent variable matched the distances in real life! It learnt IRL distance was important for predicting retail sales and reflected that!</li>
<li>Convolutions: A CNN is similar to the neural networks before, but for computer vision they have a particular feature: it can find features of images like horizontal and vertical lines of handwritten numbers.</li>
<li>How? It has a filter matrix, say a 3x3 one, and moves around, dot producting and RELUing each 3x3 subset matrix of the original image, producing a smaller image. This is called a convolution. </li>
<li>Why does this work? Because of the values in the filter. E.g. we used a 3x3 matrix with the top elements = 1, middle elements = 0, bottom = -1. The dot product of this will only give the highest value when there's horizontal image in the top row, anything in the middle, and no image in the bottom, aka whenever there's a horizontal part of an image! In vertical parts, the bottom row will cancel out the top and produce 0s, aka the convolution layer will have nothing.</li>
<li>The 3x3 matrix is called a filter.</li>
<li>We can have a horizontal edges conv layer, and a vertical edges conv layer. </li>
<li>We use another filter, but with two matrices, one for each conv layer, and to combine their features. </li>
<li>The way we find the kernal values is to set them as parameters and use SGD to optimise. It will find the best kernal parameters for optimum digit classification. </li>
<li>Nowadays we do a stride convoultion, e.g. stride 2, by skipping values. This reduces the grid size by 2x2. The grid size is not reduced by the kernal size, it is reduced determined by the stride we set.</li>
<li>When we're done with stride convos, with aboug 7x7 image at the end, we do an average pool, we average the final activations. </li>
<li>Say we're trying to identify a picture of a bear. If the bear is a small part of the picture, max pool is much better than avg pool at this. It checks each end activation for a bear, rather than having one prediction of bear or not bear for all the activations combined. </li>
<li>Depending on how you want your model to work, pick max or avg pool accordingly. Fast.ai does this for you, it actually does an average of max/avg pool that tries both for you.</li>
<li>A convolution, all the kernal multiplies done, mathematically is equivilent to just one big matrix multiplcation.</li>
<li>Dropout: we can have a dropout mask, we multiply it by our filtered image, to delete random bits of it. Higher dropout means the image is harder to see. A human is able to look at a droppedoutted image and still know what the image is. A model should be able to as well, if we dropout, perhaps it is forced to learn more fundamental features, will should help against overfitting a lot.</li>
<li>There are more activation functions/activations than ReLU. This doesn't matter much so we don't care. </li>
<li>What to do before part 2: </li>
<li>Read Meta Learning: How to Learn Deep Learning.</li>
<li>Watch the videos again and code and experiment as you go.</li>
<li>Spend time on the forums.</li>
<li>Get together with others to study together.</li>
<li>Build projects. </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Questions">Questions<a class="anchor-link" href="#Questions"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Links">Links<a class="anchor-link" href="#Links"> </a></h1><p><a href="https://www.kaggle.com/code/jhoward/first-steps-road-to-the-top-part-1">EX</a></p>
<p>The course page for this sessions is <a href="https://course.fast.ai/Lessons/lesson8.html">https://course.fast.ai/Lessons/lesson8.html</a>, which includes a lecture, notebooks, and a set of questions from the course book.</p>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/Blogs/fast.ai1/2022/09/27/Lesson8Blog.md.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/Blogs/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/Blogs/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/Blogs/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>My personal website.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/fastai" target="_blank" title="fastai"><svg class="svg-icon grey"><use xlink:href="/Blogs/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" target="_blank" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/Blogs/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
